services:

  test-basic:
    image: ghcr.io/driplineorg/dripline-python:${DLPY_IMG_TAG:-latest-dev}
    depends_on:
      - rabbit-broker
      - simple-service
    volumes:
      - ./run-tests-basic.bats:/root/run-tests-basic.bats
    command: >
      bash -c "sleep 1 &&
              /root/run-tests-basic.bats &&
              /bin/true"
    configs:
      - dl_pw.txt

  test-core:
    image: ghcr.io/driplineorg/dripline-python:${DLPY_IMG_TAG:-latest-dev}
    depends_on:
      - rabbit-broker
#      - key-value-store
#      - base-service
      - alert-consumer
    volumes:
      - ./run-tests-core.bats:/root/run-tests-core.bats
    command: >
      bash -c "sleep 1 &&
              /root/run-tests-core.bats &&
              /bin/true"
    configs:
      - dl_pw.txt